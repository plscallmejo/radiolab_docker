# radiolab_docker

Based on a Dockerfile generated by [neurodocker](https://github.com/ReproNim/neurodocker).

## Introduction

## Usage
`build.sh`
Build the basic Dockerfile and docker-docker-compose.yml,
then build the Docker image from the begining.

Usage: ./build.sh [options]
-r, --runtime        Specify the RUNTIME, either "normal" or "nvidia". (default: normal)
-c, --make-compose   Flag to make the docker-compose.yml file only, no argument is needed.
                     No Docker image will be built.
                     For making or upating docker-compose.yml.
                     e.g. you have pulled the image from somewhere else,
                         or you already have the image built, and don't want to re-build the image.
                     Note, the pre-built image should tag with "radiolab_docker:latest".
                       You can use the following command:
                         "docker tag \<pre-built image\> radiolab_docker:latest"
-s, --cn-sp          Use some cn speacialized setting.
                     T for TRUE, and F for FALSE. (default: T)
-h, --help           Show this message.

Examples:
./build.sh -r nvidia       build the Docker image using nvidia runtime.
./build.sh -r nvidia -c    make the docker-compose.yml file with nvidia runtime only,
                           but won't build the Docker image.
./build.sh -r normal       build the Docker image with normal runtime.
or ./build.sh
./build.sh -c              make the docker-compose.yml file with normal runtime only,
                           but won't build the Docker image.


`create.sh`
Create a radiolab_docker.

Usage: ./create.sh [data_path] [freesurfer_license]

Specify the "data_path" to be mounted to /DATA in inside the container.
Note, the "data_path" should be a DIR,
      and you are supposed to own the rwx permissions to it.

EXAMPLES:
./create.sh /the/path/to/your/data

`run.sh`
Run the "radiolab_docker".

Usage: ./run.sh [options]
-p, --fsl-parallel   Flag to specify the num of threads for fsl_sub.
                       0 -- off
                       1 -- on, maximum num of cores available
                       Or any num < maximum of cores
                       Note, left it unflag to a default setting
                          number of threads for fsl_sub will set to 
                          maximum num of cores - 2 (n - 2)
-h, --help           Show this message.

Examples:
./run.sh             Enter the interactive shell with \$FSLPARALLEL=\$(echo "\$\(nproc\)-2" | bc),
                       which means number of threads for fsl_sub will set to maximum num of cores - 2 (n - 2)
./run.sh -p 6        Enter the interactive shell with \$FSLPARALLEL=6,
                       which means fsl_sub will run in 6 threads

## TODOs

[TODO] AFNI fonts

[TODO] OpenGL_INDIRECT Setting in create.sh.

[TODO] Considering Buildkit.

[TODO] A python or a bash warper for running scripts in container.

[DONE] Add dcm2niix for format conversion

[DONE] Add man command

[DONE] Add MRtrix3 for DTI Tractology

[DONE] Add neovim

[DROP] Separate build dependences for further cluster distribution
